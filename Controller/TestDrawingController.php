<?php

namespace IDCI\Bundle\StepBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\Request;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Method;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Template;

/**
 * Description of TestDrawingController
 *
 * @author Antoine Ribola <antoine.ribola@gmail.com>
 */

/**
 * Test drawing controller.
 *
 * @Route("/drawstep")
 */
class TestDrawingController extends Controller 
{

    /**
     * @Route("/")
     * @Template("IDCIStepBundle:Test:testdrawing.html.twig")
     */
    public function drawstepAction() 
    {
        $json = "{ \"name\": \"senseo_order\", \"steps\": { \"address\": { \"type\": \"form\", \"options\": { \"title\": \"Adresse\", \"description\": \"Etape 1/2 : Adresses\", \"display_title\": false, \"previous_options\": { \"label\": \"Précédent\", \"attr\": { \"class\": \"secondary back\" } }, \"js\": \"$(function() { $('a.billing.update').text('Modifier').insertAfter('form .billing:not(.update):last'); $('button.shipping.update').text('Modifier').insertAfter('form .shipping:not(.update):last') })\", \"data\": { \"shipping_gender\": \"{{ '{{ user.raw.identity_gender|default(\\'\\') }}' }}\", \"shipping_firstName\": \"{{ '{{ user.raw.identity_firstName|default(\\'\\') }}' }}\", \"shipping_lastName\": \"{{ '{{ user.raw.identity_lastName|default(\\'\\') }}' }}\", \"shipping_landingPhone\": \"{{ '{{ user.raw.identity_landingPhone|default(\\'\\') }}' }}\", \"shipping_mobilePhone\": \"{{ '{{ user.raw.identity_mobilePhone|default(\\'\\') }}' }}\", \"shipping_address1\": \"{{ '{{ user.raw.identity_address1|default(\\'\\') }}' }}\", \"shipping_address2\": \"{{ '{{ user.raw.identity_address2|default(\\'\\')|raw }}' }}\", \"shipping_zipCode\": \"{{ '{{ user.raw.identity_zipCode|default(\\'\\') }}' }}\", \"shipping_city\": \"{{ '{{ user.raw.identity_city|default(\\'\\') }}' }}\", \"shipping_countryCode\": \"{{ '{{ user.raw.identity_countryCode|default(\\'\\') }}' }}\" }, \"@builder\": { \"worker\": \"extra_form_builder\", \"parameters\": { \"configuration\": { \"__billing\": { \"extra_form_type\": \"html\", \"options\": { \"content\": \"Mon adresse de facturation\", \"attr\": { \"class\": \"billing title\" } } }, \"identity_gender\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"billing gender\" } } }, \"identity_firstName\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"billing first-name\" } } }, \"identity_lastName\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"billing last-name\" } } }, \"identity_landingPhone\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"billing last-name\" } } }, \"identity_mobilePhone\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"billing last-name\" } } }, \"identity_address1\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"billing address-1\" } } }, \"identity_address2\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"billing adress-2\" } } }, \"identity_zipCode\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"billing zip-code\" } } }, \"identity_city\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"billing city\" } } }, \"identity_countryCode\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"billing country-code\" } } }, \"__shipping\": { \"extra_form_type\": \"html\", \"options\": { \"content\": \"Mon adresse de livraison\", \"attr\": { \"class\": \"shipping title\" } } }, \"shipping_gender\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"shipping gender\" } } }, \"shipping_firstName\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"shipping first-name\" } } }, \"shipping_lastName\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"shipping last-name\" } } }, \"shipping_landingPhone\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"shipping last-name\" } } }, \"shipping_mobilePhone\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"shipping last-name\" } } }, \"shipping_address1\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"shipping address-1\" } } }, \"shipping_address2\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"shipping adress-2\" } } }, \"shipping_zipCode\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"shipping zip-code\" } } }, \"shipping_city\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"shipping city\" } } }, \"shipping_countryCode\": { \"extra_form_type\": \"text\", \"options\": { \"required\": false, \"read_only\": true, \"label_attr\": { \"class\": \"readonly\" }, \"attr\": { \"class\": \"shipping country-code\" } } } } } }, \"events\": { \"form.pre_set_data\": [ { \"action\": \"add_link\", \"parameters\": { \"link_options\": { \"label\": \"Modifier mon adresse de facturation\", \"href\": \"/user/profile?redirectURL=/cart/order\", \"attr\": { \"class\": \"billing update button secondary\" } } } }, { \"action\": \"change_data\", \"parameters\": { \"fields\": { \"identity_gender\": \"{{ '{{ user.raw.identity_gender|default(\\'\\') }}' }}\", \"identity_firstName\": \"{{ '{{ user.raw.identity_firstName|default(\\'\\') }}' }}\", \"identity_lastName\": \"{{ '{{ user.raw.identity_lastName|default(\\'\\') }}' }}\", \"identity_landingPhone\": \"{{ '{{ user.raw.identity_landingPhone|default(\\'\\') }}' }}\", \"identity_mobilePhone\": \"{{ '{{ user.raw.identity_mobilePhone|default(\\'\\') }}' }}\", \"identity_address1\": \"{{ '{{ user.raw.identity_address1|default(\\'\\') }}' }}\", \"identity_address2\": \"{{ '{{ user.raw.identity_address2|default(\\'\\') }}' }}\", \"identity_zipCode\": \"{{ '{{ user.raw.identity_zipCode|default(\\'\\') }}' }}\", \"identity_city\": \"{{ '{{ user.raw.identity_city|default(\\'\\') }}' }}\", \"identity_countryCode\": \"{{ '{{ user.raw.identity_countryCode|default(\\'\\') }}' }}\" } } } ] } } }, \"shipping_address\": { \"type\": \"form\", \"options\": { \"title\": \"Adresse\", \"description\": \"Etape 1/2 : Adresses\", \"display_title\": false, \"previous_options\": { \"label\": \"Précédent\", \"attr\": { \"class\": \"secondary back\" } }, \"@builder\": { \"worker\": \"extra_form_builder\", \"parameters\": { \"configuration\": { \"__shipping\": { \"extra_form_type\": \"html\", \"options\": { \"content\": \"Modification de l'adresse de livraison\", \"attr\": { \"class\": \"shipping title\" } } }, \"__gender\": { \"extra_form_type\": \"choice\", \"options\": { \"label\": \"Civilité*\", \"expanded\": 1, \"required\": 1, \"disabled\": \"0\", \"read_only\": \"0\", \"choices\": { \"Mme\": \"Madame\", \"M.\": \"Monsieur\" }, \"mapped\": 1 }, \"constraints\": [ { \"extra_form_constraint\": \"not_blank\", \"options\": { \"message\": \"Merci de sélectionner votre civilité\" } } ] }, \"__lastName\": { \"extra_form_type\": \"text\", \"options\": { \"label\": \"Nom*\", \"required\": 1, \"disabled\": \"0\", \"read_only\": \"0\", \"pattern\": \"[A-Za-z-àâäééèêëiîïoôöuùûüç ]{1,25}\", \"mapped\": 1 }, \"constraints\": [ { \"extra_form_constraint\": \"not_blank\", \"options\": { \"message\": \"Merci de renseigner votre nom\" } }, { \"extra_form_constraint\": \"regex\", \"options\": { \"pattern\": \"#^[A-Za-z-àâäééèêëiîïoôöuùûüç ]{1,25}$#\", \"match\": true, \"message\": \"Merci de renseigner correctement votre nom.\" } } ] }, \"__firstName\": { \"extra_form_type\": \"text\", \"options\": { \"label\": \"Prénom*\", \"required\": 1, \"disabled\": \"0\", \"read_only\": \"0\", \"pattern\": \"[A-Za-z-àâäééèêëiîïoôöuùûüç ]{1,20}\", \"mapped\": 1 }, \"constraints\": [ { \"extra_form_constraint\": \"not_blank\", \"options\": { \"message\": \"Merci de renseigner votre prénom\" } }, { \"extra_form_constraint\": \"regex\", \"options\": { \"pattern\": \"#^[A-Za-z-àâäééèêëiîïoôöuùûüç ]{1,20}$#\", \"match\": true, \"message\": \"Merci de renseigner correctement votre prenom.\" } } ] }, \"__landingPhone\": { \"extra_form_type\": \"text\", \"options\": { \"label\": \"Téléphone fixe\", \"required\": 0, \"disabled\": \"0\", \"read_only\": \"0\", \"max_length\": 10, \"pattern\": \"^0[123459]{1}[0-9]{8}$\", \"mapped\": 1 }, \"constraints\": [ { \"extra_form_constraint\": \"regex\", \"options\": { \"pattern\": \"#^0[123459]{1}[0-9]{8}$#\", \"match\": true, \"message\": \"Merci de renseigner correctement votre numéro de téléphone fixe.\" } } ] }, \"__mobilePhone\": { \"extra_form_type\": \"text\", \"options\": { \"label\": \"Téléphone mobile\", \"required\": 0, \"disabled\": \"0\", \"read_only\": \"0\", \"max_length\": 10, \"pattern\": \"^0[67]{1}[0-9]{8}\", \"mapped\": 1 }, \"constraints\": [ { \"extra_form_constraint\": \"regex\", \"options\": { \"pattern\": \"#^0[67]{1}[0-9]{8}#\", \"match\": true, \"message\": \"Merci de renseigner correctement votre numéro de téléphone mobile.\" } } ] }, \"__address1\": { \"extra_form_type\": \"text\", \"options\": { \"label\": \"Adresse*\", \"required\": 1, \"disabled\": \"0\", \"read_only\": \"0\", \"mapped\": 1 }, \"constraints\": [ { \"extra_form_constraint\": \"not_blank\", \"options\": { \"message\": \"Merci de renseigner votre adresse\" } } ] }, \"__address2\": { \"extra_form_type\": \"text\", \"options\": { \"label\": \"Complément d'adresse\", \"required\": 0, \"disabled\": \"0\", \"read_only\": \"0\", \"mapped\": 1 }, \"constraints\": [ ] }, \"__zipCode\": { \"extra_form_type\": \"text\", \"options\": { \"label\": \"Code postal*\", \"required\": 1, \"disabled\": \"0\", \"read_only\": \"0\", \"max_length\": 5, \"pattern\": \"[0-9]{5}\", \"mapped\": 1 }, \"constraints\": [ { \"extra_form_constraint\": \"not_blank\", \"options\": { \"message\": \"Merci de renseigner votre code postal\" } }, { \"extra_form_constraint\": \"regex\", \"options\": { \"pattern\": \"#^[0-9]{5}$#\", \"match\": true, \"message\": \"Merci de renseigner correctement votre code postal\" } } ] }, \"__city\": { \"extra_form_type\": \"text\", \"options\": { \"label\": \"Ville*\", \"required\": 1, \"disabled\": \"0\", \"read_only\": \"0\", \"error_bubbling\": \"0\", \"pattern\": \"[A-Za-z-àâäééèêëiîïoôöuùûüç ]{1,33}\", \"mapped\": 1 }, \"constraints\": [ { \"extra_form_constraint\": \"not_blank\", \"options\": { \"message\": \"Merci de renseigner votre ville\" } }, { \"extra_form_constraint\": \"regex\", \"options\": { \"pattern\": \"#^[A-Za-z-àâäééèêëiîïoôöuùûüç ]{1,33}$#\", \"match\": true, \"message\": \"Merci de renseigner correctement votre ville.\" } } ] }, \"__countryCode\": { \"extra_form_type\": \"choice\", \"options\": { \"label\": \"Pays*\", \"required\": 1, \"disabled\": \"0\", \"read_only\": \"0\", \"error_bubbling\": \"0\", \"choices\": { \"France\": \"France\", \"Monaco\": \"Monaco\" }, \"mapped\": 1 }, \"constraints\": [ { \"extra_form_constraint\": \"not_blank\", \"options\": { \"message\": \"Merci de renseigner votre pays\" } } ] } } } }, \"events\": { \"form.pre_set_data\": [ { \"action\": \"change_data\", \"parameters\": { \"fields\": { \"__gender\": \"{{ '{{ user.raw.identity_gender|default(\\'\\') }}' }}\", \"__firstName\": \"{{ '{{ user.raw.identity_firstName|default(\\'\\') }}' }}\", \"__lastName\": \"{{ '{{ user.raw.identity_lastName|default(\\'\\') }}' }}\", \"__landingPhone\": \"{{ '{{ user.raw.identity_landingPhone|default(\\'\\') }}' }}\", \"__mobilePhone\": \"{{ '{{ user.raw.identity_mobilePhone|default(\\'\\') }}' }}\", \"__address1\": \"{{ '{{ user.raw.identity_address1|default(\\'\\') }}' }}\", \"__address2\": \"{{ '{{ user.raw.identity_address2|default(\\'\\') }}' }}\", \"__zipCode\": \"{{ '{{ user.raw.identity_zipCode|default(\\'\\') }}' }}\", \"__city\": \"{{ '{{ user.raw.identity_city|default(\\'\\') }}' }}\", \"__countryCode\": \"{{ '{{ user.raw.identity_countryCode|default(\\'\\') }}' }}\" } } } ] } } }, \"payment\": { \"type\": \"order_payment_sogenactif\", \"options\": { \"title\": \"Paiement\", \"description\": \"Etape 2/2 : Paiement\", \"previous_options\": { \"label\": \"Précédent\", \"attr\": { \"class\": \"secondary back\" } }, \"merchant_id\": \"064980182600081\", \"merchant_country\": \"fr\", \"amount\": \"{{ '{{ session.tms_order.price.amount }}' }}\", \"currency_code\": \"978\", \"force_https\": true, \"order_id\": \"{{ '{{ session.tms_order.id }}' }}\", \"message_payment_succeed|raw\": \"<p>Votre commande a bien été prise en compte.<br />Un e-mail de confirmation vient de vous être envoyé à l'adresse suivante <strong>{{ '{{ user.email }}' }}</strong><br /><br />Numéro de commande: <strong>{{ '{{ order.code }}' }}</strong><br />Date de commande: <strong>{{ '{{ order.confirmedAt|default(\\'now\\')|date(\\'d/m/Y \\\\\\\\à H:i\\') }}' }}</strong></p>\", \"message_payment_failed\": \"<p>Votre paiement a échoué.</p>\" } }, \"confirmation\": { \"type\": \"html\", \"options\": { \"title\": \"Confirmation de la commande\", \"description\": \"Félicitations !\", \"content\": \"\", \"previous_options\": { \"label\": \"Précédent\", \"attr\": { \"class\": \"secondary back\" } }, \"events\": { \"form.pre_set_data\": [ { \"action\": \"change_data\", \"parameters\": { \"fields\": { \"content\": \"<p>Votre commande a bien été prise en compte.<br />Un e-mail de confirmation vient de vous être envoyé à l'adresse suivante <strong>{{ '{{ user.email }}' }}</strong><br /><br />Numéro de commande: <strong>{{ '{{ flow_data.retrievedData.address.confirm_order.order.code }}' }}</strong><br />Date de commande: <strong>{{ '{{ flow_data.retrievedData.address.confirm_order.order.confirmedAt|default(\\'now\\')|date(\\'d/m/Y \\\\\\\\à H:i\\') }}' }}</strong></p>\" } } } ] } } } }, \"paths\": [ { \"type\": \"conditional_destination\", \"options\": { \"source\": \"address\", \"destinations\": { \"payment\": \"{{ '{{ session.tms_order.price.amount > 0 }}' }}\" }, \"default_destination\": \"confirmation\", \"next_options\": { \"label\": \"Etape suivante\", \"attr\": { \"class\": \"validate\" } }, \"events\": { \"form.post_bind\": [ { \"action\": \"persist_order_data\" }, { \"action\": \"confirm_order\", \"destinations\": [\"confirmation\"] } ] } } }, { \"type\": \"single\", \"options\": { \"source\": \"address\", \"destination\": \"shipping_address\", \"next_options\": { \"label\": \"Mon adresse de livraison\", \"attr\": { \"class\": \"shipping update secondary\" } } } }, { \"type\": \"single\", \"options\": { \"source\": \"shipping_address\", \"destination\": \"address\", \"next_options\": { \"label\": \"Valider\" }, \"events\": { \"form.post_bind\": [ { \"action\": \"change_data\", \"parameters\": { \"fields\": [ { \"value\": \"{{ '{{ flow_data.data.shipping_address.__gender }}' }}\", \"target\": { \"path\": \"address.shipping_gender\", \"types\": [\"data\", \"remindedData\"] } }, { \"value\": \"{{ '{{ flow_data.data.shipping_address.__firstName }}' }}\", \"target\": { \"path\": \"address.shipping_firstName\", \"types\": [\"data\", \"remindedData\"] } }, { \"value\": \"{{ '{{ flow_data.data.shipping_address.__lastName }}' }}\", \"target\": { \"path\": \"address.shipping_lastName\", \"types\": [\"data\", \"remindedData\"] } }, { \"value\": \"{{ '{{ flow_data.data.shipping_address.__landingPhone }}' }}\", \"target\": { \"path\": \"address.shipping_landingPhone\", \"types\": [\"data\", \"remindedData\"] } }, { \"value\": \"{{ '{{ flow_data.data.shipping_address.__mobilePhone }}' }}\", \"target\": { \"path\": \"address.shipping_mobilePhone\", \"types\": [\"data\", \"remindedData\"] } }, { \"value\": \"{{ '{{ flow_data.data.shipping_address.__address1 }}' }}\", \"target\": { \"path\": \"address.shipping_address1\", \"types\": [\"data\", \"remindedData\"] } }, { \"value\": \"{{ '{{ flow_data.data.shipping_address.__address2 }}' }}\", \"target\": { \"path\": \"address.shipping_address2\", \"types\": [\"data\", \"remindedData\"] } }, { \"value\": \"{{ '{{ flow_data.data.shipping_address.__zipCode }}' }}\", \"target\": { \"path\": \"address.shipping_zipCode\", \"types\": [\"data\", \"remindedData\"] } }, { \"value\": \"{{ '{{ flow_data.data.shipping_address.__city }}' }}\", \"target\": { \"path\": \"address.shipping_city\", \"types\": [\"data\", \"remindedData\"] } }, { \"value\": \"{{ '{{ flow_data.data.shipping_address.__countryCode }}' }}\", \"target\": { \"path\": \"address.shipping_countryCode\", \"types\": [\"data\", \"remindedData\"] } } ] } } ] } } } ] }";
            
        return array('json' => $json);
    }

}
